<html>
<head>
<title>OPFO MIS Incident Report</title>
<style type="text/css">
h1 {
	font-family: 'Roboto', sans-serif;
	font-size: 24px;
	background-color: #620A74; 
	color: white;
}

h4 {
	font-family: 'Roboto', sans-serif;
	font-size: 14px;
	text-align: center;
}

.inc {
	font-family: 'Roboto', sans-serif;
	background-color: #30DFDF;
	font-size: 16px;
	font-style: italic;
	font-weight: bold;
}

.sev {
	font-family: 'Roboto', sans-serif;
	color: red;
	font-weight: bold;
}

.incName {
	font-family: 'Roboto', sans-serif;
	color: #1C33F5;
	font-weight: bold;
	font-style: italic;
}

.loc {
	font-family: 'Roboto', sans-serif;
	background-color: #F5EC94;
}

</style>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />

</head>

<body>
	<h1>OPFO MIS - Field Incident Notification</h1>
	<br>
	<table style="width: 80%">
		<tbody>
			<tr class="inc">
				<td width="15%"><b>Incident:</b></td>
				<td width="35%"><p class="incName" th:text="${incident_name}"></p> </td>
				<td width="10%"><b>Severity:</b></td>
				<td width="40%"><p class="sev" th:text="${incident_severity}"></p> </td>
			</tr>
			<tr>
				<td><b>Date:</b></td>
				<td><p th:text="${incident_date}"></p> </td>
				<td></td>
				<td></td>
			</tr>
			<tr class="loc">
				<td colspan="2"><b>Location Details:</b></td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td><b>Company:</b></td>
				<td><p th:text="${company}"></p> </td>
				<td><b>Estate:</b></td>
				<td><p th:text="${estate}"></p> </td>
			</tr>
			<tr>
				<td><b>Block:</b></td>
				<td><p th:text="${block}"></p> </td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td><b>Notes:</b></td>
				<td><p th:text="${notes}"></p> </td>
				<td></td>
				<td></td>
			</tr>
		</tbody>
	</table>
	<table>
		<tbody>
			<tr>
				<td><b>Reported by: </b></td>
				<td><p th:text="${user_first_name} + ' ' + ${user_last_name}"></p> </td>
			</tr>
		</tbody>
	</table>
<hr>
	<table style="width: 100%">
		<tbody>
			<tr>
				<td><h4> -- Please note that this email was auto-generated by OPFO MIS -- </h4> </td>
			</tr>
		</tbody>
	</table>

	<div id="map" style="height: 500px; margin-top: 20px;"></div>

</body>

<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

<script>

var map = L.map('map').setView([-2.5401,112.3513], 13);

L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);

// Load the GeoJSON data and add it to the map
  fetch('https://majchinthaka.github.io/aick.json/aick.json')
    .then(function (response) {
      return response.json();
    })
    .then(function (data) {
      L.geoJSON(data).addTo(map);
    });

L.marker([th:text="${gps_log}",th:text="${gps_lat}"]).addTo(map)
    .bindPopup('
    										<strong>Transaction No:</strong> {location.transactionNo} <br/>
                                            <strong>Reported Date | Time:</strong> {dateTimeToReadable(location.createdDate)} <br/>
                                            <strong>Block Code:</strong> {location.blockCode} <br/>
                                            <strong>Company:</strong> {location.companyName} <br/>
                                            <strong>Estate:</strong> {location.estateName} <br/>
                                            <strong>Reported By:</strong> {location.createdBy} <br/>
                                            <strong>Incident Severity:</strong> {location.incidentSevName} <br/>
                                            <strong>Status:</strong> {location.status} <br/>
    ')
    .openPopup();

</script/>

</html>